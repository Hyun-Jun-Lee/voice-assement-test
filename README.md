# μ‹¬λ¦¬κ²€μ‚¬ μμ„± μΈν„°νμ΄μ¤ (Psychological Assessment Voice Interface)

μμ„± λ…λ Ήμ„ ν†µν•΄ μ‹¬λ¦¬κ²€μ‚¬λ¥Ό μ§„ν–‰ν•  μ μλ” μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. SvelteKitκ³Ό OpenRouter APIλ¥Ό ν™μ©ν•μ—¬ μμ—°μ–΄ λ…λ Ήμ„ μ²λ¦¬ν•κ³ , TTS(Text-to-Speech) κΈ°λ¥μ„ ν†µν•΄ μ ‘κ·Όμ„±μ„ ν–¥μƒμ‹μΌ°μµλ‹λ‹¤.

## μ£Όμ” κΈ°λ¥

- π¤ **μμ„± λ…λ Ή μ²λ¦¬**: μμ—°μ–΄λ΅ κ²€μ‚¬ μ§„ν–‰ ("Cλ¥Ό μ²΄ν¬ν•΄μ¤", "λ‹¤μ λ¬Έν•­μΌλ΅ κ°€μ¤")
- π¤– **LLM Tool Calling**: OpenRouter APIλ¥Ό ν†µν• μ§€λ¥ν• λ…λ Ή ν•΄μ„
- π” **TTS μ§€μ›**: λ¬Έν•­ λ° μ‘λ‹µ μλ™ μ½κΈ° (Phase 3 μ¤€λΉ„ μ™„λ£)
- π“ **μ‹¤μ‹κ°„ μ§„ν–‰λ¥ **: λ‹µλ³€ μ™„λ£ μƒν™© μ‹¤μ‹κ°„ ν‘μ‹
- π― **μ¤λ§νΈ λ„¤λΉ„κ²μ΄μ…**: λ―Έλ‹µλ³€ λ¬Έν•­ μλ™ νƒμƒ‰ λ° μ΄λ™
- π› **λ””λ²„κ·Έ ν¨λ„**: κ°λ° μ¤‘ μƒνƒ λ¨λ‹ν„°λ§

## κΈ°μ  μ¤νƒ

- **Frontend**: SvelteKit, Svelte 5
- **State Management**: Svelte Stores (writable, derived)
- **LLM Integration**: OpenRouter API (Tool Calling)
- **Styling**: Custom CSS with CSS Variables
- **Build Tool**: Vite

## ν”„λ΅μ νΈ κµ¬μ΅°

```
voice-pasych-test/
β”β”€β”€ src/
β”‚   β”β”€β”€ lib/
β”‚   β”‚   β”β”€β”€ components/
β”‚   β”‚   β”‚   β”β”€β”€ assessment/        # κ²€μ‚¬ κ΄€λ ¨ UI μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β”‚   β”β”€β”€ AnswerSelector.svelte
β”‚   β”‚   β”‚   β”‚   β”β”€β”€ CommandInput.svelte
β”‚   β”‚   β”‚   β”‚   β”β”€β”€ CommandHistory.svelte
β”‚   β”‚   β”‚   β”‚   β”β”€β”€ ProgressBar.svelte
β”‚   β”‚   β”‚   β”‚   β”β”€β”€ QuestionCard.svelte
β”‚   β”‚   β”‚   β”‚   β””β”€β”€ VoiceButton.svelte
β”‚   β”‚   β”‚   β”β”€β”€ ui/                # κ³µν†µ UI μ»΄ν¬λ„νΈ
β”‚   β”‚   β”‚   β”‚   β”β”€β”€ Button.svelte
β”‚   β”‚   β”‚   β”‚   β””β”€β”€ StatusMessage.svelte
β”‚   β”‚   β”‚   β””β”€β”€ debug/             # λ””λ²„κ·Έ ν¨λ„
β”‚   β”‚   β”‚       β””β”€β”€ DebugPanel.svelte
β”‚   β”‚   β”β”€β”€ data/                  # λ°μ΄ν„° λ μ΄μ–΄
β”‚   β”‚   β”‚   β”β”€β”€ questions.js       # λ¬Έν•­ λ°μ΄ν„°
β”‚   β”‚   β”‚   β””β”€β”€ constants.js       # μƒμ μ •μ
β”‚   β”‚   β”β”€β”€ services/              # λΉ„μ¦λ‹μ¤ λ΅μ§ λ μ΄μ–΄
β”‚   β”‚   β”‚   β”β”€β”€ commandProcessor.js    # λ…λ Ή μ²λ¦¬ (OpenRouter)
β”‚   β”‚   β”‚   β”β”€β”€ questionService.js     # λ¬Έν•­ λ°μ΄ν„° κ΄€λ¦¬
β”‚   β”‚   β”‚   β””β”€β”€ ttsService.js          # TTS μ„λΉ„μ¤ (Phase 3 μ¤€λΉ„)
β”‚   β”‚   β”β”€β”€ stores/                # μƒνƒ κ΄€λ¦¬
β”‚   β”‚   β”‚   β”β”€β”€ testStore.js       # κ²€μ‚¬ μ§„ν–‰ μƒνƒ
β”‚   β”‚   β”‚   β”β”€β”€ commandStore.js    # λ…λ Ή μ²λ¦¬ μƒνƒ
β”‚   β”‚   β”‚   β””β”€β”€ uiStore.js         # UI μƒνƒ
β”‚   β”‚   β””β”€β”€ assets/
β”‚   β”‚       β””β”€β”€ favicon.svg
β”‚   β”β”€β”€ routes/
β”‚   β”‚   β”β”€β”€ +layout.svelte         # μ „μ—­ λ μ΄μ•„μ›ƒ
β”‚   β”‚   β”β”€β”€ +page.svelte           # ν™νμ΄μ§€
β”‚   β”‚   β””β”€β”€ assessment/
β”‚   β”‚       β””β”€β”€ +page.svelte       # κ²€μ‚¬ νμ΄μ§€ (λ©”μΈ)
β”‚   β”β”€β”€ app.html                   # HTML ν…ν”λ¦Ώ
β”‚   β””β”€β”€ app.css                    # μ „μ—­ μ¤νƒ€μΌ
β”β”€β”€ static/                        # μ •μ  νμΌ
β”β”€β”€ docs/                          # ν”„λ΅μ νΈ λ¬Έμ„
β”‚   β”β”€β”€ project.md                 # ν”„λ΅μ νΈ κ°μ”
β”‚   β””β”€β”€ DSL.md                     # λ„λ©”μΈ μ–Έμ–΄ μ •μ
β”β”€β”€ .env.example                   # ν™κ²½ λ³€μ ν…ν”λ¦Ώ
β”β”€β”€ package.json
β””β”€β”€ README.md
```

## μ•„ν‚¤ν…μ²

### λ μ΄μ–΄ κµ¬μ΅°

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚        Pages (Routes)               β”‚  β† μ‚¬μ©μ μΈν„°νμ΄μ¤
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚     Components (UI Layer)           β”‚  β† μ¬μ‚¬μ© κ°€λ¥ν• UI
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚      Stores (State Layer)           β”‚  β† μ „μ—­ μƒνƒ κ΄€λ¦¬
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚    Services (Business Logic)        β”‚  β† API νΈμ¶, λ°μ΄ν„° μ²λ¦¬
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚       Data (Data Layer)             β”‚  β† μ •μ  λ°μ΄ν„°, μƒμ
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μ£Όμ” λ°μ΄ν„° ν”λ΅μ°

1. **λ…λ Ή μ…λ ¥** β†’ CommandInput μ»΄ν¬λ„νΈ
2. **λ…λ Ή μ²λ¦¬** β†’ commandProcessor.js (OpenRouter API)
3. **μƒνƒ μ—…λ°μ΄νΈ** β†’ Stores (testStore, commandStore)
4. **UI λ°μ** β†’ μ»΄ν¬λ„νΈ λ¦¬λ λ”λ§
5. **TTS μ‹¤ν–‰** β†’ ttsService.js (μλ™ μ½κΈ°)

## μ„¤μΉ λ° μ‹¤ν–‰

### 1. ν™κ²½ μ„¤μ •

```bash
# μμ΅΄μ„± μ„¤μΉ
npm install

# ν™κ²½ λ³€μ μ„¤μ •
cp .env.example .env
```

`.env` νμΌμ— OpenRouter API ν‚¤λ¥Ό μ¶”κ°€ν•μ„Έμ”:

```env
VITE_OPENROUTER_API_KEY=your_api_key_here
VITE_MODEL_NAME=openai/gpt-4
VITE_APP_URL=http://localhost:5173
```

### 2. κ°λ° μ„λ²„ μ‹¤ν–‰

```bash
# κ°λ° μ„λ²„ μ‹μ‘
npm run dev

# λΈλΌμ°μ € μλ™ μ—΄κΈ°
npm run dev -- --open
```

κ°λ° μ„λ²„λ” `http://localhost:5173`μ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

### 3. ν”„λ΅λ•μ… λΉλ“

```bash
# ν”„λ΅λ•μ… λΉλ“ μƒμ„±
npm run build

# λΉλ“ κ²°κ³Ό λ―Έλ¦¬λ³΄κΈ°
npm run preview
```

## μ‚¬μ© λ°©λ²•

### κ²€μ‚¬ νμ΄μ§€ μ ‘μ†

1. ν™νμ΄μ§€(`/`)μ—μ„ "κ²€μ‚¬ μ‹μ‘" λ²„νΌ ν΄λ¦­
2. κ²€μ‚¬ νμ΄μ§€(`/assessment`)λ΅ μ΄λ™

### λ…λ Ή μμ‹

#### λ‹µλ³€ μ²΄ν¬
- "Aλ¥Ό μ²΄ν¬ν•΄μ¤"
- "λ³΄ν†µ"
- "λ§¤μ° κ·Έλ ‡λ‹¤"

#### λ„¤λΉ„κ²μ΄μ…
- "λ‹¤μ λ¬Έν•­"
- "μ΄μ „ λ¬Έν•­"
- "3λ²μΌλ΅ κ°€μ¤"

#### μ΅°ν
- "μ§„ν–‰ μƒν™© μ•λ ¤μ¤"
- "μ•μΌλ΅ λ‡ λ¬Έν•­ λ‚¨μ•μ–΄?"
- "3λ² λ‹µλ³€ λ­μ€μ–΄?"

#### λ³µν•© λ…λ Ή
- "Cλ¥Ό μ²΄ν¬ν• ν›„ 8λ²μΌλ΅ λ„μ–΄κ°€μ¤"
- "λ³΄ν†µ μ²΄ν¬ν•κ³  λ‹¤μμΌλ΅ κ°€μ¤"

## κ°λ° λ‹¨κ³„ (Phases)

### β… Phase 1-2: ν…μ¤νΈ λ…λ Ή μ²λ¦¬ (μ™„λ£)
- SvelteKit ν”„λ΅μ νΈ μ„¤μ •
- OpenRouter API μ—°λ™
- Tool Calling κµ¬ν„
- κΈ°λ³Έ UI μ»΄ν¬λ„νΈ
- μƒνƒ κ΄€λ¦¬ (Svelte Stores)
- Multi-tool calling μ§€μ›
- μ¤λ§νΈ λ„¤λΉ„κ²μ΄μ…

### π§ Phase 3: μμ„± μΈν„°νμ΄μ¤ (μμ •)
- Whisper API μ—°λ™ (μμ„± μ…λ ¥)
- OpenAI TTS API μ—°λ™ (μμ„± μ¶λ ¥)
- μμ„± λ…Ήμ UI κ°μ„ 

### π“… Phase 4: λ°μ΄ν„°λ² μ΄μ¤ μ—°λ™ (μμ •)
- Supabase μ—°λ™
- μ‚¬μ©μ μ„Έμ… κ΄€λ¦¬
- κ²€μ‚¬ κ²°κ³Ό μ €μ¥
- ν†µκ³„ λ¶„μ„

## μ£Όμ” κΈ°λ¥ μƒμ„Έ

### 1. LLM Tool Calling

OpenRouter APIλ¥Ό ν†µν•΄ μμ—°μ–΄ λ…λ Ήμ„ κµ¬μ΅°ν™”λ ν•¨μ νΈμ¶λ΅ λ³€ν™:

- `check_answer`: λ‹µλ³€ μ²΄ν¬
- `next_question`: λ‹¤μ λ¬Έν•­
- `previous_question`: μ΄μ „ λ¬Έν•­
- `go_to_question`: νΉμ • λ¬Έν•­ μ΄λ™
- `get_progress`: μ§„ν–‰ μƒν™© μ΅°ν
- `get_answer`: νΉμ • λ‹µλ³€ μ΅°ν

### 2. μ¤λ§νΈ λ„¤λΉ„κ²μ΄μ…

λ‹µλ³€ ν›„ λ―Έλ‹µλ³€ λ¬Έν•­μΌλ΅ μλ™ μ΄λ™:
1. ν„μ¬ λ¬Έν•­ μ΄ν›„ νƒμƒ‰
2. μ—†μΌλ©΄ μ²μλ¶€ν„° νƒμƒ‰
3. λ¨λ“  λ‹µλ³€ μ™„λ£ μ‹ μ•λ‚΄ λ©”μ‹μ§€

### 3. TTS μ‹λ®¬λ μ΄μ…

Phase 3 μ¤€λΉ„λ¥Ό μ„ν• TTS λ΅κ·Έ:
- λ¬Έν•­ μλ™ μ½κΈ°
- μ„ νƒμ§€ μ•λ‚΄
- μ‘λ‹µ λ©”μ‹μ§€ μ½κΈ°

## κ°λ° λ„κµ¬

### Debug Panel

ν™”λ©΄ μ°μΈ΅ ν•λ‹¨μ "Debug ON" λ²„νΌμΌλ΅ ν™μ„±ν™”:
- ν„μ¬ κ²€μ‚¬ μƒνƒ
- λ‹µλ³€ ν„ν™©
- λ§μ§€λ§‰ λ…λ Ή
- μ„±κ³µ/μ—λ¬ λ©”μ‹μ§€
- Store μ •λ³΄ (Raw JSON)

### Command History

"νμ¤ν† λ¦¬ λ³΄κΈ°" λ²„νΌμΌλ΅ ν™•μΈ:
- μ‹¤ν–‰ν• λ…λ Ή λ©λ΅
- νƒ€μ„μ¤νƒ¬ν”„
- μμ„± ν…μ¤νΈ (Phase 3)

## ν™κ²½ λ³€μ

| λ³€μλ… | μ„¤λ… | κΈ°λ³Έκ°’ |
|--------|------|--------|
| `VITE_OPENROUTER_API_KEY` | OpenRouter API ν‚¤ | (ν•„μ) |
| `VITE_MODEL_NAME` | μ‚¬μ©ν•  LLM λ¨λΈ | `openai/gpt-4` |
| `VITE_APP_URL` | μ• ν”λ¦¬μΌ€μ΄μ… URL | `http://localhost:5173` |

## λ¬Έμ  ν•΄κ²°

### API νΈμ¶ μ‹¤ν¨
- `.env` νμΌμ— μ¬λ°”λ¥Έ API ν‚¤κ°€ μ„¤μ •λμ–΄ μλ”μ§€ ν™•μΈ
- κ°λ° μ„λ²„ μ¬μ‹μ‘ (`npm run dev`)

### λ…λ Ήμ΄ μΈμ‹λμ§€ μ•μ
- Debug Panelμ—μ„ λ§μ§€λ§‰ λ…λ Ή ν™•μΈ
- μ½μ†”μ—μ„ OpenRouter μ”μ²­/μ‘λ‹µ λ΅κ·Έ ν™•μΈ

### μ¤νƒ€μΌμ΄ κΉ¨μ§
- λΈλΌμ°μ € μΊμ‹ μ‚­μ 
- `node_modules` μ‚­μ  ν›„ μ¬μ„¤μΉ

## λΌμ΄μ„ μ¤

MIT License

## κΈ°μ—¬

μ΄μ λ° ν’€ λ¦¬ν€μ¤νΈλ” μ–Έμ λ“ μ§€ ν™μν•©λ‹λ‹¤.
